(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{269:function(t,e,a){"use strict";a.r(e);var s=a(543);var n=a(432);for(var i in n)if(["default"].indexOf(i)<0)(function(t){a.d(e,t,(function(){return n[t]}))})(i);var r=a(531);var o=a(2);var l=Object(o["a"])(n["default"],s["a"],s["b"],false,null,"a654aed2",null);e["default"]=l.exports},432:function(t,e,a){"use strict";a.r(e);var s=a(433);var n=a.n(s);for(var i in s)if(["default"].indexOf(i)<0)(function(t){a.d(e,t,(function(){return s[t]}))})(i);e["default"]=n.a},433:function(t,e,a){"use strict";var s=a(1);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var n=s(a(274));var i=s(a(8));var r=s(a(5));var o=s(a(275));var l=s(a(6));var u=s(a(17));var c=s(a(279));var d=s(a(272));var p=s(a(276));var f=s(a(440));var h=s(a(447));var m=s(a(278));var g=a(10);var v=a(9);var b=s(a(74));function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);if(e)s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,s)}return a}function k(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};if(e%2){_(Object(a),true).forEach((function(e){(0,u.default)(t,e,a[e])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))}else{_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}}return t}var y={name:"TaskDetail",components:{Tips:d.default,StrategyTemplate:f.default,ExceptionCard:h.default},mixins:[c.default,m.default,b.default],props:{taskId:{type:[String,Number],default:""},status:{type:String,default:""}},data:function t(){return{loading:false,tableLoading:false,stopLoading:false,retryLoading:false,isShowCopy:false,copyDisabled:true,taskStatus:"",loadMessage:true,installReg:/^(?!re)(install)/gi,staticDetal:{failed:0,filtered:0,success:0,running:0,pending:0,all:0},jobType:"",jobTypeDisplay:"",timestamp:"",selected:[],filterData:[{name:"IP",type:"innerIp",id:"ip"},{name:this.$t("执行状态"),id:"status",multiable:true,children:[{id:"PENDING",name:this.$t("等待执行"),checked:false},{id:"RUNNING",name:this.$t("正在执行"),checked:false},{id:"SUCCESS",name:this.$t("执行成功"),checked:false},{id:"FAILED",name:this.$t("执行失败"),checked:false},{id:"FILTERED",name:this.$t("已忽略"),checked:false}]}],pagination:{limit:50,current:1,count:0,limitList:[50,100,200]},tableList:[],selectedHosts:[],titleStatusMap:{running:this.$t("正在执行"),failed:this.$t("执行失败"),part_failed:this.$t("部分失败"),success:this.$t("执行成功"),stop:this.$t("已终止"),pending:this.$t("等待执行"),terminated:this.$t("已终止"),filtered:this.$t("已忽略")},getDetailListDebounce:function t(){},statusMap:{success:this.$t("个成功"),failed:this.$t("个失败"),filtered:this.$t("个忽略"),running:this.$t("个执行中"),pending:this.$t("个等待执行")},ipRegx:/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,copyLoading:false,copyTypeList:[{name:this.$t("所有IP"),key:""},{name:this.$t("被忽略IP"),key:"filtered"},{name:this.$t("失败IP"),key:"failed"},{name:this.$t("成功IP"),key:"success"}],slider:{show:false,title:"",isSingle:false,hostType:"",hostSys:""},commandLoading:false,commandData:[],commandError:false}},computed:k(k(k(k({},(0,v.mapGetters)(["fontSize"])),(0,v.mapGetters)("task",["routetParent"])),(0,v.mapGetters)("agent",["cloudList"])),{},{navTitle:function t(){return"".concat(this.$t("任务详情")," ").concat(this.jobTypeDisplay," ").concat(this.timestamp)},treeShakingStatus:function t(){var e=this;return Object.keys(this.staticDetal).filter((function(t){return t!=="all"&&!!e.staticDetal[t]})).map((function(t){return{status:t,value:e.staticDetal[t]}}))},isInstallType:function t(){return this.installReg.test(this.jobType)},operateHost:function t(){var e=/(agent)|(proxy)|(plugin)/gi.exec(this.jobType);return e?e[0]:""},isManualType:function t(){return this.tableList.some((function(t){return t.isManual}))},hasCommandTaskType:function t(){if(!this.operateHost||this.operateHost==="plugin"||!this.isManualType){return false}return/(^(?!UN)(INSTALL))|(REINSTALL)|(UPGRADE)/gi.test(this.jobType)},vewCommandStep:function t(){var e=/(^(?!UN)(INSTALL))|(REINSTALL)|(UPGRADE)/gi.exec(this.jobType);var a=e?e[0]:"";if(a==="install"){return 2}if(a==="reinstall"||a==="upgrade"){return 1}return NaN},hasFaileHosts:function t(){return this.selectedHosts.some((function(t){return t.status==="stop"||t.status==="failed"}))},hasRunningHosts:function t(){return this.selectedHosts.some((function(t){return t.status==="running"}))},hostList:function t(){var e=this.tableList.map((function(t){return{bk_cloud_id:t.bkCloudId,bk_cloud_name:t.bkCloudName,ap_id:t.apId,inner_ip:t.innerIp}}));e.sort((function(t,e){return t.bk_cloud_id-e.bk_cloud_id}));return e}}),watch:{searchSelectValue:{handler:function t(){this.getDetailListDebounce()},deep:true},taskStatus:function t(e){this.runingQueue=e==="running"?[1]:[]}},created:function t(){if(this.status){this.numFilterHandle(this.status)}else{this.getHistoryTaskDetail()}},mounted:function t(){this.getDetailListDebounce=(0,g.debounce)(300,this.pageChange)},beforeRouteLeave:function t(e,a,s){this.setToggleDefaultContent(false);s()},methods:k(k(k(k({},(0,v.mapMutations)(["setToggleDefaultContent"])),(0,v.mapActions)("task",["requestHistoryTaskDetail","requestTaskStop","requestTaskRetry","requestCommands"])),(0,v.mapActions)("agent",["getCloudList"])),{},{getHistoryTaskDetail:function t(){var e=this;return(0,l.default)(r.default.mark((function t(){var a,s,n,i,l,u,c,d,p,f;return r.default.wrap((function t(r){while(1){switch(r.prev=r.next){case 0:e.tableLoading=true;r.next=3;return e.requestHistoryTaskDetail({id:e.taskId,params:e.getCommonParams()});case 3:a=r.sent;if(a){n=a.list,i=a.statistics,l=a.status,u=a.jobType,c=a.jobTypeDisplay,d=a.startTime,p=a.total,f=a.ipFilterList;n.forEach((function(t){t.loading=false}));e.taskStatus=l?l.toLowerCase():"";e.jobType=(0,g.toHump)((u||"").toLowerCase());e.jobTypeDisplay=c||"--";e.timestamp=d||"";(s=e.tableList).splice.apply(s,[0,e.tableList.length].concat((0,o.default)(n)));e.pagination.count=p||0;e.handleStatistics(i,f)}if(e.isManualType){e.getCloudList()}e.tableLoading=false;case 7:case"end":return r.stop()}}}),t)})))()},handleStatistics:function t(e,a){if(e){var s=e.successCount,n=e.failedCount,r=e.filterCount,o=e.runningCount,l=e.pendingCount,u=e.totalCount;(0,i.default)(this.staticDetal,{failed:n||0,filtered:r||0,success:s||0,running:o||0,pending:l||0,all:u||0});if(this.loadMessage){if(r&&a&&a.length){this.$bkMessage({theme:"warning",offsetY:53,ellipsisLine:2,message:this.$t("已忽略信息提示",{num:r,ip:a[0]})})}this.loadMessage=false}}},getCommonParams:function t(){var e={page:this.pagination.current,pagesize:this.pagination.limit};var a=[];var s=this.searchSelectValue.reduce((function(t,e){if(e.values){var a=e.values.map((function(t){return t.id}));if(Object.prototype.hasOwnProperty.call(t,e.id)){t[e.id]=t[e.id].concat(a)}else{t[e.id]=a}}else{t[e.id]=[e.name]}return t}),{});Object.entries(s).forEach((function(t){var e=(0,n.default)(t,2),s=e[0],i=e[1];var r=(0,o.default)(new Set(i));a.push({key:s==="status"?s:"ip",value:s==="status"?r:r.join(",")})}));if(a.length){e.conditions=a}return e},handlePollData:function t(){var e=this;return(0,l.default)(r.default.mark((function t(){var a,s,n,i,l,u,c,d;return r.default.wrap((function t(r){while(1){switch(r.prev=r.next){case 0:r.next=2;return e.requestHistoryTaskDetail({id:e.taskId,params:e.getCommonParams()});case 2:a=r.sent;if(a){n=a.list,i=a.statistics,l=a.status,u=a.jobType,c=a.jobTypeDisplay,d=a.total;e.taskStatus=l?l.toLowerCase():"";e.jobType=(0,g.toHump)((u||"").toLowerCase());e.jobTypeDisplay=c||"--";e.pagination.count=d||0;n.forEach((function(t){var a=e.tableList.find((function(e){return e.instanceId===t.instanceId}));t.loading=a?a.loading:false}));(s=e.tableList).splice.apply(s,[0,e.tableList.length].concat((0,o.default)(n)));e.handleStatistics(i)}return r.abrupt("return",a);case 5:case"end":return r.stop()}}}),t)})))()},pageChange:function t(e){this.pagination.current=e||1;this.getHistoryTaskDetail()},paginationChange:function t(e){this.pagination.limit=e||10;this.getDetailListDebounce()},copyDropdownShow:function t(){this.isCopyDropdownShow=true},copyDropdownHide:function t(){this.isCopyDropdownShow=false},handleCopy:function t(e){var a=this;return(0,l.default)(r.default.mark((function t(){var s,n,o,l,u;return r.default.wrap((function t(r){while(1){switch(r.prev=r.next){case 0:a.$refs.dropdownCopy.hide();s={pagesize:-1};if(e.key){s.conditions=[{key:"status",value:[e.key.toUpperCase()]}]}a.copyLoading=true;r.next=6;return a.requestHistoryTaskDetail({id:a.taskId,params:s});case 6:n=r.sent;if(n){o={theme:"error",message:a.$t("IP复制失败")};if(n.list?n.list.length:false){l=n.list.map((function(t){return t.innerIp})).join("\n");u=(0,g.copyText)(l);if(u){(0,i.default)(o,{theme:"success",message:a.$t("IP复制成功",{num:n.list.length})})}}a.$bkMessage(o)}a.copyLoading=false;case 9:case"end":return r.stop()}}}),t)})))()},handleViewLogDetail:function t(e){this.$router.push({name:"taskLog",params:{taskId:this.taskId,instanceId:e.instanceId.toString()}})},handleTaskStop:function t(){var e=this;var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return(0,l.default)(r.default.mark((function t(){var s,n,i;return r.default.wrap((function t(r){while(1){switch(r.prev=r.next){case 0:s=!a.length;if(!(!s&&a.find((function(t){return t.loading})))){r.next=3;break}return r.abrupt("return",false);case 3:e.stopLoading=true;n=s?[]:a;e.setRowsLoading(n,true);r.next=8;return e.requestTaskStop({jobId:e.taskId,params:{instance_id_list:n.map((function(t){return t.instanceId}))}});case 8:i=r.sent;if(i.result){e.staticDetal.failed+=n.length;e.staticDetal.running-=n.length;e.handleStatistics();e.setRowsStatus(n,"failed")}e.stopLoading=false;e.setRowsLoading(n,false);if(!i.result){r.next=15;break}r.next=15;return e.handlePollData();case 15:case"end":return r.stop()}}}),t)})))()},handleTaskRetry:function t(){var e=this;var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return(0,l.default)(r.default.mark((function t(){var s,n,i;return r.default.wrap((function t(r){while(1){switch(r.prev=r.next){case 0:s=!a.length;n=s?[]:a;if(!(!s&&a.find((function(t){return t.loading})))){r.next=4;break}return r.abrupt("return",false);case 4:e.retryLoading=true;e.setRowsLoading(n,true);r.next=8;return e.requestTaskRetry({jobId:e.taskId,params:{instance_id_list:n.map((function(t){return t.instanceId}))}});case 8:i=r.sent;e.retryLoading=false;if(i.result){e.taskStatus="running";e.setRowsStatus(n,"pending");e.staticDetal.failed-=n.length;e.staticDetal.pending+=n.length;e.handleStatistics()}e.setRowsLoading(n,false);if(!i.result){r.next=15;break}r.next=15;return e.handlePollData();case 15:case"end":return r.stop()}}}),t)})))()},setRowsStatus:function t(e,a){var s=this;e.forEach((function(t){if(a==="pending"&&t.status==="failed"){t.status=a;t.statusDisplay=s.$t("等待执行")}else if(a==="failed"&&(t.status==="pending"||t.status==="running")){t.status=a;t.statusDisplay=s.$t("已终止")}}))},setRowsLoading:function t(e,a){e.forEach((function(t){t.loading=a}))},handleBack:function t(){this.routerBack()},numFilterHandle:function t(e){if(!e)return;var a=this.filterData.find((function(t){return t.id==="status"})).children.find((function(t){return t.id===e}));this.handleSearchSelectChange([{name:this.$t("执行状态"),id:"status",values:[a]}]);this.searchSelectValue.splice(0,this.searchSelectValue.length);this.handlePushValue("status",[a],false)},filterrdHandle:function t(e){if(e.jobId&&e.exception&&e.exception==="is_running"){this.$router.push({name:"taskLog",params:{taskId:e.jobId,hostInnerIp:e.innerIp}})}},filteredTitle:function t(e){return"".concat(this.titleStatusMap[e.status]," ").concat((e.statusDisplay||"").replace(/\s+/g," "))},requestCommandData:function t(e){var a=this;return(0,l.default)(r.default.mark((function t(){var s,n,o,l;return r.default.wrap((function t(r){while(1){switch(r.prev=r.next){case 0:if(a.commandLoading){r.next=9;break}a.commandLoading=true;r.next=4;return a.requestCommands({jobId:a.taskId,params:{bk_host_id:e?e.bkHostId:-1}});case 4:s=r.sent;if(s){n=[];if(e){o=s[e.bkCloudId];l=o?o.ipsCommands.find((function(t){return t.ip===e.innerIp})):null;a.slider.hostSys=l?l.osType:"";if(l){n.push((0,i.default)({isFold:false,cloudId:e.cloudId},l))}}else{Object.keys(s).forEach((function(t){var e={isFold:false,cloudId:parseInt(t),cloudName:""};if(parseInt(t)===window.PROJECT_CONFIG.DEFAULT_CLOUD){e.cloudName=a.$t("直连区域")}else{var r=a.cloudList.find((function(e){return"".concat(e.bkCloudId)===t||e.bkCloudId===window.PROJECT_CONFIG.DEFAULT_CLOUD}));e.cloudName=r?r.bkCloudName:t}n.push((0,i.default)(e,s[t]))}))}a.commandData=n}a.commandError=!s;a.commandLoading=false;return r.abrupt("return",s);case 9:return r.abrupt("return",false);case 10:case"end":return r.stop()}}}),t)})))()},copyCommand:function t(e,a){var s=this;return(0,l.default)(r.default.mark((function t(){var n,o,l,u,c,d,p,f,h;return r.default.wrap((function t(r){while(1){switch(r.prev=r.next){case 0:if(!(!e||s.commandLoading)){r.next=2;break}return r.abrupt("return",false);case 2:n=Object.prototype.hasOwnProperty.call(e,"isFold");o=true;if(n){r.next=8;break}r.next=7;return s.requestCommandData(e);case 7:o=r.sent;case 8:l="";if(e){if(n){u=s.$refs["commanad".concat(e.cloudId)];l=u?u[a].textContent:""}else{c=s.commandData.find((function(t){return t.cloudId===e.bkCloudId}));d=c?c.ipsCommands:[];p=d.find((function(t){return t.ip===e.innerIp}));l=p?p.command.replace(/<[^>]+>/gi,""):""}}else{l=s.commandData.map((function(t){return t.totalCommands.replace(/<[^>]+>/gi,"")})).join("\n")}f={theme:"error",message:s.$t("命令复制失败")};if(o&&l){h=(0,g.copyText)(l);if(h){(0,i.default)(f,{theme:"success",message:s.$t("命令复制成功")})}}s.$bkMessage(f);case 13:case"end":return r.stop()}}}),t)})))()},viewCommand:function t(e){this.commandError=false;this.slider.show=true;this.slider.isSingle=!!e;if(e){if(this.operateHost==="Proxy"){this.slider.hostType=this.operateHost}else{this.slider.hostType=e.bkCloudId===window.PROJECT_CONFIG.DEFAULT_CLOUD?"Agent":"Pagent"}}else{this.slider.hostType=this.operateHost==="Proxy"?this.operateHost:"mixed"}this.slider.title=this.$t("手动安装sliderTitle",{ip:e?e.innerIp:""});this.requestCommandData(e)},toggleCommand:function t(e){e.isFold=!e.isFold},tableSelectHandle:function t(e){this.selectedHosts=e},selectAbleHandle:function t(e){return e.status!=="filtered"&&e.status!=="pendding"},renderHeader:function t(){var e=this.$createElement;return e(p.default)},colspanHandle:function t(e){var a=e.column;if(a.property==="colspaOpera"){return[1,2]}if(a.property==="colspaSetting"){return[0,0]}},installTypeCell:function t(e){if((0,g.isEmpty)(e)){return"--"}return e?this.$t("手动"):this.$t("远程")}})};e.default=y},434:function(t,e,a){},531:function(t,e,a){"use strict";var s=a(434);var n=a.n(s);var i=n.a},543:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));a.d(e,"b",(function(){return n}));var s=function(){var t=this;var e=t.$createElement;var a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.loading},expression:"{ isLoading: loading }"}],staticClass:"task-detail-wrapper"},[!t.loading?[a("div",{staticClass:"nodeman-navigation-content mb20"},[a("span",{staticClass:"content-icon",on:{click:t.handleBack}},[a("i",{staticClass:"nodeman-icon nc-back-left"})]),t._v(" "),a("span",{staticClass:"content-header"},[t._v(t._s(t.navTitle))]),t._v(" "),t.taskStatus?a("div",{staticClass:"content-subtitle"},[a("span",{class:"tab-badge bg-"+t.taskStatus},[t._v(t._s(t.titleStatusMap[t.taskStatus]||t.$t("状态未知")))])]):t._e()]),t._v(" "),t.isManualType?a("Tips",{staticClass:"mb20",scopedSlots:t._u([{key:"default",fn:function(){return[a("p",[t._v("\n          "+t._s(t.$t("手动安装任务Tips"))+"\n        ")])]},proxy:true}],null,false,3049701702)}):t._e(),t._v(" "),a("section",{staticClass:"detail-option clearfix"},[a("bk-button",{staticClass:"fl",attrs:{"hover-theme":"danger",loading:t.stopLoading,disabled:t.staticDetal.running===0||t.stopLoading},on:{click:t.handleTaskStop}},[t._v("\n        "+t._s(t.stopLoading?"":t.$t("终止"))+"\n      ")]),t._v(" "),a("bk-button",{staticClass:"fl ml10",attrs:{loading:t.retryLoading,disabled:t.staticDetal.failed===0||t.retryLoading},on:{click:function(e){e.stopPropagation();return t.handleTaskRetry(e)}}},[t._v("\n        "+t._s(t.$t("失败重试"))+"\n      ")]),t._v(" "),a("bk-dropdown-menu",{ref:"dropdownCopy",staticClass:"fl",attrs:{trigger:"click","font-size":"medium",disabled:t.copyLoading},on:{show:function(e){return t.copyDropdownShow("copy")},hide:function(e){return t.copyDropdownHide("copy")}}},[a("bk-button",{staticClass:"copy-dropdown-btn",attrs:{slot:"dropdown-trigger",type:"primary",loading:t.copyLoading},slot:"dropdown-trigger"},[a("span",{staticClass:"icon-down-wrapper"},[a("span",[t._v(t._s(t.$t("复制")))]),t._v(" "),a("i",{class:["bk-icon icon-angle-down",{"icon-flip":t.isShowCopy}]})])]),t._v(" "),a("ul",{staticClass:"bk-dropdown-list",attrs:{slot:"dropdown-content"},slot:"dropdown-content"},t._l(t.copyTypeList,(function(e){return a("li",{key:e.key},[a("a",{attrs:{href:"javascript:"},on:{click:function(a){a.preventDefault();a.stopPropagation();return t.handleCopy(e)}}},[t._v(t._s(e.name))])])})),0)],1),t._v(" "),a("bk-search-select",{staticClass:"fr task-filter-select",attrs:{"split-code":",","show-condition":false,placeholder:t.$t("请输入"),data:t.searchSelectData},on:{change:t.handleSearchSelectChange},model:{value:t.searchSelectValue,callback:function(e){t.searchSelectValue=e},expression:"searchSelectValue"}})],1),t._v(" "),a("section",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.tableLoading},expression:"{ isLoading: tableLoading }"}],staticClass:"task-table"},[a("div",{staticClass:"table-header"},[a("div",{staticClass:"table-header-left"},[a("span",{staticClass:"package-name"},[t._v(t._s(t.jobTypeDisplay))]),t._v(" "),a("i18n",{staticClass:"package-selection",attrs:{path:"机器数量"}},[a("span",{staticClass:"selection-num"},[t._v(t._s(t.staticDetal.all))])])],1),t._v(" "),a("div",{staticClass:"table-header-right"},[t._l(t.treeShakingStatus,(function(e,s){return[a("span",{key:e.status},[a("span",{class:"filter-num "+e.status,on:{click:function(a){t.numFilterHandle(e.status.toLocaleUpperCase())}}},[t._v("\n                "+t._s(e.value)+"\n              ")]),t._v("\n              "+t._s(t.statusMap[e.status])+"\n              "),s!==t.treeShakingStatus.length-1?a("span",{staticClass:"separator"},[t._v(",")]):t._e(),t._v(" "),e.status==="running"&&s===t.treeShakingStatus.length-1?a("span",{staticClass:"dot"},[t._v("...")]):t._e()])]}))],2)]),t._v(" "),a("bk-table",{ref:"agentTable",class:"head-customize-table "+t.fontSize,attrs:{"row-key":"innerIp",data:t.tableList,pagination:t.pagination,"limit-list":t.pagination.limitList,"span-method":t.colspanHandle},on:{"page-change":t.pageChange,"page-limit-change":t.paginationChange,select:t.tableSelectHandle,"select-all":t.tableSelectHandle}},[a("bk-table-column",{attrs:{"class-name":"row-ip",label:"IP",prop:"innerIp",resizable:false},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n            "+t._s(a.innerIp||"--")+"\n          ")]}}],null,false,3410640472)}),t._v(" "),a("bk-table-column",{attrs:{label:t.$t("云区域"),prop:"bkCloudName",resizable:false},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n            "+t._s(a.bkCloudName||"--")+"\n          ")]}}],null,false,1516841984)}),t._v(" "),a("bk-table-column",{attrs:{"min-width":"100",label:t.$t("业务"),prop:"bkBizName",resizable:false},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n            "+t._s(a.bkBizName||"--")+"\n          ")]}}],null,false,3665081856)}),t._v(" "),a("bk-table-column",{attrs:{"min-width":"100",label:t.$t("安装方式"),prop:"isManual",resizable:false},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n            "+t._s(t.installTypeCell(a.isManual))+"\n          ")]}}],null,false,3994060961)}),t._v(" "),a("bk-table-column",{attrs:{prop:"status",label:t.$t("执行状态"),"min-width":"220","render-header":t.renderFilterHeader},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("div",{staticClass:"col-execution"},[s.status==="running"?a("loading-icon"):a("span",{class:"execut-mark execut-"+s.status}),t._v(" "),s.status==="filtered"?a("span",{class:["execut-text",{"has-icon":s.exception&&s.exception==="is_running"}],attrs:{title:t.filteredTitle(s)},on:{click:function(e){e.stopPropagation();return t.filterrdHandle(s)}}},[t._v("\n                "+t._s(t.titleStatusMap[s.status]+" ")+"\n                ("+t._s(s.statusDisplay||"--")),s.exception&&s.exception==="is_running"?a("i",{staticClass:"nodeman-icon nc-icon-audit filtered-icon"}):t._e(),t._v(")\n              ")]):a("span",[t._v(t._s(s.statusDisplay||"--"))])],1)]}}],null,false,2616444896)}),t._v(" "),a("bk-table-column",{attrs:{prop:"colspaOpera",width:(t.hasCommandTaskType?158:93)+(t.fontSize==="large"?20:0),label:t.$t("操作"),resizable:false},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[t.hasCommandTaskType?[s.nodeId>=t.vewCommandStep||s.status==="success"?a("bk-button",{staticClass:"mr10",attrs:{text:"",theme:"primary",disabled:t.commandLoading},on:{click:function(e){return t.viewCommand(s)}}},[t._v("\n                "+t._s(t.$t("命令btn"))+"\n              ")]):t._e()]:t._e(),t._v(" "),s.status!=="filtered"?a("bk-button",{staticClass:"mr10",attrs:{text:"",theme:"primary"},on:{click:function(e){e.stopPropagation();return t.handleViewLogDetail(s)}}},[t._v("\n              "+t._s(t.$t("查看日志"))+"\n            ")]):t._e(),t._v(" "),s.loading?a("loading-icon"):[s.status==="failed"?a("bk-button",{attrs:{text:"",theme:"primary"},on:{click:function(e){return t.handleTaskRetry([s])}}},[t._v("\n                "+t._s(t.$t("重试"))+"\n              ")]):t._e(),t._v(" "),s.status==="running"?a("bk-button",{attrs:{text:"",theme:"primary"},on:{click:function(e){return t.handleTaskStop([s])}}},[[t._v(t._s(t.$t("终止")))]],2):t._e()]]}}],null,false,3888204961)}),t._v(" "),a("bk-table-column",{key:"setting",attrs:{prop:"colspaSetting","render-header":t.renderHeader,width:"42",resizable:false}})],1)],1)]:t._e(),t._v(" "),a("bk-sideslider",{attrs:{"ext-cls":"commands-slider",width:620,"is-show":t.slider.show,title:t.slider.title,"quick-close":true},on:{"update:isShow":function(e){return t.$set(t.slider,"show",e)},"update:is-show":function(e){return t.$set(t.slider,"show",e)}}},[a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.commandLoading},expression:"{ isLoading: commandLoading }"}],staticClass:"commands-wrapper",attrs:{slot:"content"},slot:"content"},[t.slider.hostSys==="WINDOWS"?[a("p",{staticClass:"guide-title"},[t._v(t._s(t.$t("slider安装windows",{type:"Agent"})))]),t._v(" "),a("p",{staticClass:"guide-title"},[t._v("\n          1. "+t._s(t.$t("windowsStrategy1Before"))+"\n          "),a("span",{staticClass:"guide-link"},[t._v(" curl.exe ")]),t._v("\n          "+t._s(t.$t("windowsStrategy1After"))+"\n        ")]),t._v(" "),a("p",{staticClass:"guide-title"},[t._v("2. "+t._s(t.$t("windowsStrategy2")))])]:a("p",{staticClass:"guide-title"},[t._v(t._s(t.$t("slider安装title",{type:t.operateHost})))]),t._v(" "),a("p",{staticClass:"guide-title"},[t.slider.hostSys==="WINDOWS"?[t._v("3. "+t._s(t.$t("windowsStrategy3"))+" ")]:[t._v(t._s(t.$t("linuxStrategy1")))],t._v(" "),a("bk-popover",{ref:"popover",attrs:{trigger:"click",theme:"light silder-guide",placement:"bottom-start"},scopedSlots:t._u([{key:"content",fn:function(){return[t.slider.show?a("StrategyTemplate",{staticClass:"operation-tips",attrs:{"host-type":t.slider.hostType,"host-list":t.hostList}}):t._e()]},proxy:true}])},[a("span",{staticClass:"guide-link pointer"},[t._v(t._s(t.$t("网络策略开通指引")))])])],2),t._v(" "),t.slider.hostSys!=="WINDOWS"?a("Tips",{staticClass:"mb20",scopedSlots:t._u([{key:"default",fn:function(){return[a("p",[t._v("\n            "+t._s(t.$t("请将安装指令中的"))+"\n            "),a("span",{staticClass:"tips-text-decs"},[t._v(t._s(t.$t("账号")))]),t._v(" "),a("span",{staticClass:"tips-text-decs"},[t._v(t._s(t.$t("端口")))]),t._v(" "),a("span",{staticClass:"tips-text-decs"},[t._v(t._s(t.$t("密码密钥")))]),t._v("\n            "+t._s(t.$t("替换成"))+"\n            "),a("span",{staticClass:"tips-text-decs"},[t._v(t._s(t.$t("真实数据")))]),t._v("\n            "+t._s(t.$t("再执行"))+"\n          ")])]},proxy:true}],null,false,2586416471)}):t._e(),t._v(" "),!t.commandError?[t.commandData.length?a("ul",{staticClass:"commands-list"},t._l(t.commandData,(function(e,s){return a("li",{key:e.cloudId,staticClass:"commands-item"},[!t.slider.isSingle?a("p",{staticClass:"commands-title mb10"},[t._v(t._s(e.cloudName))]):t._e(),t._v(" "),a("div",{class:["command-conatainer",{fold:e.isFold,single:t.slider.isSingle}]},[a("div",{ref:"commanad"+e.cloudId,refInFor:true,staticClass:"commands-left",domProps:{innerHTML:t._s(t.slider.isSingle?e.command:e.totalCommands)}}),t._v(" "),a("div",{staticClass:"commands-right"},[a("p",[a("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{delay:[300,0],content:t.$t("复制命令")},expression:"{\n                    delay: [300, 0],\n                    content: $t('复制命令')\n                  }"}],staticClass:"nodeman-icon nc-copy command-icon",on:{click:function(a){return t.copyCommand(e,s)}}})])])])])})),0):a("ExceptionCard",{attrs:{type:"dataAbnormal"}})]:t._e()],2)])],2)};var n=[]}}]);