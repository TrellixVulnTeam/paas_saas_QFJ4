(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{256:function(t,e,a){"use strict";a.r(e);var n=a(557);var o=a(361);for(var r in o)if(["default"].indexOf(r)<0)(function(t){a.d(e,t,(function(){return o[t]}))})(r);var i=a(492);var l=a(2);var s=Object(l["a"])(o["default"],n["a"],n["b"],false,null,"16ca5083",null);e["default"]=s.exports},361:function(t,e,a){"use strict";a.r(e);var n=a(362);var o=a.n(n);for(var r in n)if(["default"].indexOf(r)<0)(function(t){a.d(e,t,(function(){return n[t]}))})(r);e["default"]=o.a},362:function(t,e,a){"use strict";var n=a(1);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var o=n(a(5));var r=n(a(274));var i=n(a(6));var l=n(a(17));var s=n(a(272));var u=a(9);var c=a(10);var d=n(a(276));var p=n(a(281));function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};if(e%2){f(Object(a),true).forEach((function(e){(0,l.default)(t,e,a[e])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))}else{f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}}return t}var b={name:"cloud-manager",components:{Tips:s.default},props:{id:{type:Number,default:0}},data:function t(){return{tipsList:[this.$t("云区域管理提示一")],table:{list:[],data:[]},pagination:{current:1,limit:20,count:0},searchValue:"",searchParams:["bkCloudName","bkCloudId","ispName","apName"],handleValueChange:function t(){},loading:false,deleteTips:this.$t("删除禁用提示")}},computed:h(h(h({},(0,u.mapGetters)(["fontSize","permissionSwitch"])),(0,u.mapGetters)("cloud",["authority"])),{},{tableData:function t(){var e=this.pagination,a=e.current,n=e.limit;var o=(a-1)*n;return this.table.data.slice(o,o+n)},proxyOperateList:function t(){return this.authority.proxy_operate||[]}}),created:function t(){this.handleInit()},mounted:function t(){this.handleValueChange=(0,c.debounce)(300,this.handleSearch)},methods:h(h({},(0,u.mapActions)("cloud",["getCloudList","deleteCloud"])),{},{handleInit:function t(){var e=this;return(0,i.default)(o.default.mark((function t(){var a,n,i,l;return o.default.wrap((function t(o){while(1){switch(o.prev=o.next){case 0:e.loading=true;a=[e.getCloudList()];o.next=4;return Promise.all(a);case 4:n=o.sent;i=(0,r.default)(n,1);l=i[0];if(e.permissionSwitch){l.sort((function(t,e){return Number(e.view)-Number(t.view)}))}e.table.list=l.map((function(t){return h(h({},t),{},{cloudNameCopy:t.bkCloudName.toLocaleLowerCase()})}));e.handleSearch();e.loading=false;case 11:case"end":return o.stop()}}}),t)})))()},handleSearch:function t(){var e=this;this.table.data=this.searchValue.length===0?this.table.list:this.table.list.filter((function(t){return e.searchParams.some((function(a){var n=e.searchValue.toLocaleLowerCase();return t[a]&&~t[a].toString().toLocaleLowerCase().indexOf(n)}))}));this.pagination.current=1;this.pagination.count=this.table.data.length},handleEdit:function t(e){this.$router.push({name:"addCloudManager",params:{id:e.bkCloudId,type:"edit"}})},handleDelete:function t(e){var a=this;var n=function(){var t=(0,i.default)(o.default.mark((function t(e){var n;return o.default.wrap((function t(o){while(1){switch(o.prev=o.next){case 0:a.loading=true;o.next=3;return a.deleteCloud(e);case 3:n=o.sent;if(n){a.$bkMessage({theme:"success",message:a.$t("删除成功")});a.handleInit()}else{a.loading=false}case 5:case"end":return o.stop()}}}),t)})));return function e(a){return t.apply(this,arguments)}}();this.$bkInfo({title:this.$t("确定删除该云区域"),confirmFn:function t(){n(e.bkCloudId)}})},handleAddCloud:function t(){this.$router.push({name:"addCloudManager",params:{type:"add"}})},handleGotoDetail:function t(e){this.$router.push({name:"cloudManagerDetail",params:{id:e.bkCloudId}})},handleInstallProxy:function t(e){this.$router.push({name:"setupCloudManager",params:{type:"create",id:e.bkCloudId}})},renderHeader:function t(){var e=this.$createElement;return e(d.default)},colspanHandle:function t(e){var a=e.column;if(a.property==="colspaOpera"){return[1,2]}if(a.property==="colspaSetting"){return[0,0]}},handleGotoAgent:function t(e){this.$router.push({name:"agentStatus",params:{cloud:{id:e.bkCloudId,name:e.bkCloudName}}})},handlePageChange:function t(e){this.pagination.current=e||1},handlePageLimitChange:function t(e){this.pagination.limit=e||20;this.handlePageChange()}})};e.default=b},363:function(t,e,a){},492:function(t,e,a){"use strict";var n=a(363);var o=a.n(n);var r=o.a},557:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a.d(e,"b",(function(){return o}));var n=function(){var t=this;var e=t.$createElement;var a=t._self._c||e;return a("article",{staticClass:"cloud-manager"},[a("section",{staticClass:"cloud-tips mb20"},[a("tips",{attrs:{list:t.tipsList}})],1),t._v(" "),a("section",{staticClass:"cloud-content"},[a("div",{staticClass:"content-header mb15"},[a("auth-component",{attrs:{tag:"div",auth:{permission:t.authority.create_action,apply_info:[{action:"cloud_create"}]}},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.disabled;return[a("bk-button",{attrs:{theme:"primary",disabled:n,"ext-cls":"header-btn"},on:{click:t.handleAddCloud}},[t._v("\n            "+t._s(t.$t("新建"))+"\n          ")])]}}])}),t._v(" "),a("bk-input",{attrs:{placeholder:t.$t("搜索名称"),"right-icon":"bk-icon icon-search","ext-cls":"header-input"},on:{change:t.handleValueChange},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.loading},expression:"{ isLoading: loading }"}],staticClass:"content-table"},[a("bk-table",{class:"head-customize-table "+t.fontSize,attrs:{pagination:t.pagination,"span-method":t.colspanHandle,data:t.tableData},on:{"page-change":t.handlePageChange,"page-limit-change":t.handlePageLimitChange}},[a("bk-table-column",{attrs:{label:t.$t("云区域名称"),prop:"cloudNameCopy",sortable:"","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("auth-component",{staticClass:"auth-inline",attrs:{tag:"div",auth:{permission:n.view,apply_info:[{action:"cloud_view",instance_id:n.bkCloudId,instance_name:n.bkCloudName}]}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.disabled;return[a("span",{staticClass:"text-btn",attrs:{disabled:o},on:{click:function(e){return t.handleGotoDetail(n)}}},[t._v("\n                  "+t._s(n.bkCloudName)+"\n                ")])]}}],null,true)})]}}])}),t._v(" "),a("bk-table-column",{attrs:{label:t.$t("云区域ID"),prop:"bkCloudId"}}),t._v(" "),a("bk-table-column",{attrs:{align:"right",width:"55",resizable:false},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.ispIcon?a("img",{staticClass:"col-svg",attrs:{src:"data:image/svg+xml;base64,"+n.ispIcon}}):t._e()]}}])}),t._v(" "),a("bk-table-column",{attrs:{label:t.$t("云服务商"),prop:"ispName",sortable:"","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n            "+t._s(a.ispName||"--")+"\n          ")]}}])}),t._v(" "),a("bk-table-column",{attrs:{label:t.$t("Proxy数量"),width:"150",prop:"proxyCount",align:"right",resizable:false,sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.proxyCount?a("auth-component",{staticClass:"auth-inline",attrs:{tag:"div",auth:{permission:n.view,apply_info:[{action:"cloud_view",instance_id:n.bkCloudId,instance_name:n.bkCloudName}]}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.disabled;return[a("bk-button",{attrs:{"ext-cls":"col-btn",theme:"primary",text:"",disabled:o},on:{click:function(e){return t.handleGotoDetail(n)}}},[t._v("\n                  "+t._s(n.proxyCount)+"\n                ")])]}}],null,true)}):a("auth-component",{staticClass:"auth-inline",attrs:{tag:"span",auth:{permission:!!t.proxyOperateList.length,apply_info:[{action:"proxy_operate"}]}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.disabled;return[a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.$t("点击前往安装"),expression:"$t('点击前往安装')"}],staticClass:"install-proxy",attrs:{disabled:o}},[a("i",{staticClass:"install-proxy-icon nodeman-icon nc-minus"}),t._v(" "),a("span",{on:{click:function(e){return t.handleInstallProxy(n)}}},[t._v(t._s(t.$t("未安装")))])])]}}],null,true)})]}}])}),t._v(" "),a("bk-table-column",{attrs:{label:t.$t("节点数量"),prop:"nodeCount",align:"right",resizable:false,sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.nodeCount?a("span",{staticClass:"text-btn",on:{click:function(e){return t.handleGotoAgent(n)}}},[t._v(t._s(n.nodeCount))]):a("span",[t._v("0")])]}}])}),t._v(" "),a("bk-table-column",{attrs:{align:"right","min-width":"40"}}),t._v(" "),a("bk-table-column",{attrs:{label:t.$t("接入点"),prop:"apName","show-overflow-tooltip":""}}),t._v(" "),a("bk-table-column",{attrs:{prop:"colspaOpera",label:t.$t("操作"),width:t.fontSize==="large"?175:155,resizable:false},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("auth-component",{attrs:{tag:"div",auth:{permission:!!t.proxyOperateList.length,apply_info:n.view?[{action:"proxy_operate"}]:[{action:"proxy_operate"},{action:"cloud_view",instance_id:n.bkCloudId,instance_name:n.bkCloudName}]}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.disabled;return[a("bk-button",{attrs:{text:"","ext-cls":"col-btn",theme:"primary",disabled:o},on:{click:function(e){return t.handleInstallProxy(n)}}},[t._v("\n                  "+t._s(t.$t("Proxy安装"))+"\n                ")])]}}],null,true)}),t._v(" "),a("auth-component",{staticClass:"auth-inline",attrs:{tag:"div",auth:{permission:n.edit,apply_info:[{action:"cloud_edit",instance_id:n.bkCloudId,instance_name:n.bkCloudName}]}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.disabled;return[a("bk-button",{attrs:{"ext-cls":"col-btn ml10",theme:"primary",text:"",disabled:o},on:{click:function(e){return t.handleEdit(n)}}},[t._v("\n                  "+t._s(t.$t("编辑"))+"\n                ")])]}}],null,true)}),t._v(" "),a("auth-component",{staticClass:"auth-inline",attrs:{tag:"div",auth:{permission:n.delete,apply_info:[{action:"cloud_delete",instance_id:n.bkCloudId,instance_name:n.bkCloudName}]}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.disabled;return[a("bk-popover",{staticClass:"ml10",attrs:{content:t.deleteTips,disabled:!(n.proxyCount||n.nodeCount)}},[a("bk-button",{attrs:{"ext-cls":"col-btn",disabled:o||!!(n.proxyCount||n.nodeCount),theme:"primary",text:""},on:{click:function(e){return t.handleDelete(n)}}},[t._v("\n                    "+t._s(t.$t("删除"))+"\n                  ")])],1)]}}],null,true)})]}}])}),t._v(" "),a("bk-table-column",{key:"setting",attrs:{prop:"colspaSetting","render-header":t.renderHeader,width:"42",resizable:false}})],1)],1)])])};var o=[]}}]);