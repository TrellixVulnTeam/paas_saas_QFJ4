(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{262:function(t,e,a){"use strict";a.r(e);var i=a(551);var n=a(400);for(var s in n)if(["default"].indexOf(s)<0)(function(t){a.d(e,t,(function(){return n[t]}))})(s);var r=a(517);var l=a(2);var o=Object(l["a"])(n["default"],i["a"],i["b"],false,null,"b18752f6",null);e["default"]=o.exports},400:function(t,e,a){"use strict";a.r(e);var i=a(401);var n=a.n(i);for(var s in i)if(["default"].indexOf(s)<0)(function(t){a.d(e,t,(function(){return i[t]}))})(s);e["default"]=n.a},401:function(t,e,a){"use strict";var i=a(1);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var n=i(a(5));var s=i(a(6));var r=i(a(17));var l=i(a(8));var o=i(a(277));var c=i(a(75));var u=a(13);var m=a(9);function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);if(e)i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,i)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};if(e%2){f(Object(a),true).forEach((function(e){(0,r.default)(t,e,a[e])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))}else{f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}}return t}var d={name:"TaskConfig",components:{ExceptionPage:c.default},mixins:[o.default],data:function t(){return{loading:false,submitLoading:false,configParam:{installPAgentTimeout:300,installAgentTimeout:300,installProxyTimeout:300,installDownloadLimitSpeed:0,parallelInstallNumber:100,nodeManLogLevel:"ERROR"},defaultsParam:{},logLevelMap:[{id:"ERROR",name:"Error"},{id:"INFO",name:"Info"},{id:"DEBUG",name:"Debug"}],hasPermission:true,rules:{must:[{required:true,message:this.$t("必填项"),trigger:"blur"}],speed:[{required:true,message:this.$t("必填项"),trigger:"blur"},{validator:function t(e){return/^\d+$/.test(e)},message:this.$t("整数最小值校验提示",{min:0}),trigger:"blur"}],install:[{required:true,message:this.$t("必填项"),trigger:"blur"},{validator:function t(e){return/^\+?[1-9][0-9]*$/.test(e)&&Number(e)<=2e3},message:this.$t("整数范围校验提示",{max:2e3,min:1}),trigger:"blur"}],outTime:[{required:true,message:this.$t("必填项"),trigger:"blur"},{validator:function t(e){return/^\d+$/.test(e)&&Number(e)<=86400},message:this.$t("整数范围校验提示",{max:86400,min:0}),trigger:"blur"}]}}},created:function t(){this.hasPermission=window.PROJECT_CONFIG.GLOBAL_TASK_CONFIG_PERMISSION==="True"},mounted:function t(){if(this.hasPermission){(0,l.default)(this.defaultsParam,this.configParam);this.requestConfig();this.initLabelWidth(this.$refs.taskConfigForm)}},methods:p(p({},(0,m.mapActions)("config",["requestGlobalSettings","saveGlobalSettings"])),{},{submitHandler:function t(){var e=this;this.$refs.taskConfigForm.validate().then((function(){e.saveConfig()})).catch((function(){}))},resetHandler:function t(){(0,l.default)(this.configParam,this.defaultsParam)},requestConfig:function t(){var e=this;return(0,s.default)(n.default.mark((function t(){var a;return n.default.wrap((function t(i){while(1){switch(i.prev=i.next){case 0:e.loading=true;i.next=3;return e.requestGlobalSettings();case 3:a=i.sent;(0,l.default)(e.configParam,a.jobSettings);e.loading=false;case 6:case"end":return i.stop()}}}),t)})))()},saveConfig:function t(){var e=this;return(0,s.default)(n.default.mark((function t(){var a,i,s,r,l,o,c,u;return n.default.wrap((function t(n){while(1){switch(n.prev=n.next){case 0:e.submitLoading=true;a=e.configParam,i=a.installPAgentTimeout,s=a.installAgentTimeout,r=a.installProxyTimeout,l=a.installDownloadLimitSpeed,o=a.parallelInstallNumber,c=a.nodeManLogLevel;n.next=4;return e.saveGlobalSettings({install_p_agent_timeout:i,install_agent_timeout:s,install_proxy_timeout:r,install_download_limit_speed:l,parallel_install_number:o,node_man_log_level:c});case 4:u=n.sent;if(u.result){e.$bkMessage({theme:"success",message:e.$t("保存配置成功")})}e.submitLoading=false;case 7:case"end":return n.stop()}}}),t)})))()},handleApplyPermission:function t(){u.bus.$emit("show-permission-modal",{apply_info:[{action:"globe_task_config"}]})}})};e.default=d},402:function(t,e,a){},517:function(t,e,a){"use strict";var i=a(402);var n=a.n(i);var s=n.a},551:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a.d(e,"b",(function(){return n}));var i=function(){var t=this;var e=t.$createElement;var a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.loading},expression:"{ isLoading: loading }"}],class:["task-config-wrapper",{"permission-disabled":!t.hasPermission}]},[t.hasPermission?a("section",{staticClass:"task-config-container"},[a("bk-form",{ref:"taskConfigForm",staticClass:"task-config-form",attrs:{"label-width":165,model:t.configParam}},[a("div",{staticClass:"bk-form-info-item clearfix"},[a("bk-form-item",{staticClass:"fl",attrs:{label:t.$t("安装PAgent超时时间"),required:true,rules:t.rules.outTime,property:"installPAgentTimeout","error-display-type":"normal"}},[a("bk-input",{attrs:{placeholder:t.$t("请输入")},model:{value:t.configParam.installPAgentTimeout,callback:function(e){t.$set(t.configParam,"installPAgentTimeout",typeof e==="string"?e.trim():e)},expression:"configParam.installPAgentTimeout"}},[a("template",{slot:"append"},[a("div",{staticClass:"group-text"},[t._v("s")])])],2),t._v(" "),a("bk-popover",{staticClass:"info-tooltips",attrs:{theme:"light",placement:"right-start"}},[a("span",{staticClass:"nodeman-icon nc-tips-fill fl info-tooltips-icon"}),t._v(" "),a("div",{staticClass:"info-tooltips-content",attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.$t("安装PAgent超时时间tip")))])])],1)],1),t._v(" "),a("div",{staticClass:"bk-form-info-item clearfix"},[a("bk-form-item",{staticClass:"fl",attrs:{label:t.$t("安装Agent超时时间"),required:true,rules:t.rules.outTime,property:"installAgentTimeout","error-display-type":"normal"}},[a("bk-input",{attrs:{placeholder:t.$t("请输入")},model:{value:t.configParam.installAgentTimeout,callback:function(e){t.$set(t.configParam,"installAgentTimeout",typeof e==="string"?e.trim():e)},expression:"configParam.installAgentTimeout"}},[a("template",{slot:"append"},[a("div",{staticClass:"group-text"},[t._v("s")])])],2),t._v(" "),a("bk-popover",{staticClass:"info-tooltips",attrs:{theme:"light",placement:"right-start"}},[a("span",{staticClass:"nodeman-icon nc-tips-fill fl info-tooltips-icon"}),t._v(" "),a("div",{staticClass:"info-tooltips-content",attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.$t("安装Agent超时时间tip")))])])],1)],1),t._v(" "),a("div",{staticClass:"bk-form-info-item clearfix"},[a("bk-form-item",{staticClass:"fl",attrs:{label:t.$t("安装Proxy超时时间"),required:true,rules:t.rules.outTime,property:"installProxyTimeout","error-display-type":"normal"}},[a("bk-input",{attrs:{placeholder:t.$t("请输入")},model:{value:t.configParam.installProxyTimeout,callback:function(e){t.$set(t.configParam,"installProxyTimeout",typeof e==="string"?e.trim():e)},expression:"configParam.installProxyTimeout"}},[a("template",{slot:"append"},[a("div",{staticClass:"group-text"},[t._v("s")])])],2),t._v(" "),a("bk-popover",{staticClass:"info-tooltips",attrs:{theme:"light",placement:"right-start"}},[a("span",{staticClass:"nodeman-icon nc-tips-fill fl info-tooltips-icon"}),t._v(" "),a("div",{staticClass:"info-tooltips-content",attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.$t("安装Proxy超时时间tip")))])])],1)],1),t._v(" "),a("div",{staticClass:"bk-form-info-item clearfix"},[a("bk-form-item",{staticClass:"fl",attrs:{label:t.$t("安装下载限速"),required:true,rules:t.rules.speed,property:"installDownloadLimitSpeed","error-display-type":"normal"}},[a("bk-input",{attrs:{placeholder:t.$t("请输入")},model:{value:t.configParam.installDownloadLimitSpeed,callback:function(e){t.$set(t.configParam,"installDownloadLimitSpeed",typeof e==="string"?e.trim():e)},expression:"configParam.installDownloadLimitSpeed"}},[a("template",{slot:"append"},[a("div",{staticClass:"group-text"},[t._v("KB/s")])])],2),t._v(" "),a("bk-popover",{staticClass:"info-tooltips",attrs:{theme:"light",placement:"right-start"}},[a("span",{staticClass:"nodeman-icon nc-tips-fill fl info-tooltips-icon"}),t._v(" "),a("div",{staticClass:"info-tooltips-content",attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.$t("安装下载限速tip")))])])],1)],1),t._v(" "),a("div",{staticClass:"bk-form-info-item clearfix"},[a("bk-form-item",{staticClass:"fl",attrs:{label:t.$t("并行安装数"),required:true,rules:t.rules.install,property:"parallelInstallNumber","error-display-type":"normal"}},[a("bk-input",{attrs:{placeholder:t.$t("请输入")},model:{value:t.configParam.parallelInstallNumber,callback:function(e){t.$set(t.configParam,"parallelInstallNumber",typeof e==="string"?e.trim():e)},expression:"configParam.parallelInstallNumber"}})],1)],1),t._v(" "),a("div",{staticClass:"bk-form-info-item clearfix"},[a("bk-form-item",{staticClass:"fl",attrs:{label:t.$t("节点管理日志级别"),required:true,rules:t.rules.must,property:"nodeManLogLevel","error-display-type":"normal"}},[a("bk-select",{attrs:{"ext-cls":"log-level-select",clearable:false},model:{value:t.configParam.nodeManLogLevel,callback:function(e){t.$set(t.configParam,"nodeManLogLevel",e)},expression:"configParam.nodeManLogLevel"}},t._l(t.logLevelMap,(function(t){return a("bk-option",{key:t.id,attrs:{id:t.id,name:t.name}})})),1)],1)],1),t._v(" "),a("div",{staticClass:"bk-form-info-item item-button-group mt30 clearfix"},[a("bk-form-item",[a("bk-button",{staticClass:"nodeman-primary-btn",attrs:{theme:"primary",loading:t.submitLoading,disabled:t.submitLoading},on:{click:t.submitHandler}},[t._v("\n                        "+t._s(t.$t("保存"))+"\n                    ")]),t._v(" "),a("bk-button",{staticClass:"nodeman-cancel-btn",attrs:{theme:"default",disabled:t.submitLoading},on:{click:t.resetHandler}},[t._v("\n                        "+t._s(t.$t("重置"))+"\n                    ")])],1)],1)])],1):a("exception-page",{attrs:{type:"notPower","sub-title":t.$t("全局任务Auth")},on:{click:t.handleApplyPermission}})],1)};var n=[]}}]);